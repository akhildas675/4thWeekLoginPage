{"version":3,"sources":["webpack://sift/webpack/universalModuleDefinition","webpack://sift/webpack/bootstrap","webpack://sift/./es5m/utils.js","webpack://sift/./es5m/core.js","webpack://sift/./test.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","extendStatics","typeChecker","type","typeString","getClassName","toString","comparable","Date","getTime","isArray","map","toJSON","isObject","equals","a","b","length","length_1","keys","__extends","setPrototypeOf","__proto__","Array","__","constructor","__spreadArrays","il","arguments","k","j","jl","walkKeyPathValues","item","keyPath","next","depth","owner","currentKey","isNaN","Number","BaseOperation","params","owneryQuery","options","init","reset","done","success","GroupOperation","_super","_children","_this","length_2","childrenNext","length_3","childOperation","QueryOperation","apply","parent","NestedOperation","children","_nextNestedValue","EqualsOperation","_test","compare","Function","RegExp","test","comparableA","createOperation","NopeOperation","parentQuery","operationCreator","operations","Error","createNestedOperation","nestedQuery","query","charAt","containsOperation","_a","createQueryOperations","selfOperations","nestedOperations","push","op","split","$test","$where","defaultOperations","ownertQuery","_b","operation","ops","createQueryOperation","assign"],"mappings":"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","file":"sift.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"sift\"] = factory();\n\telse\n\t\troot[\"sift\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export var typeChecker = function (type) {\n    var typeString = \"[object \" + type + \"]\";\n    return function (value) {\n        return getClassName(value) === typeString;\n    };\n};\nvar getClassName = function (value) { return Object.prototype.toString.call(value); };\nexport var comparable = function (value) {\n    if (value instanceof Date) {\n        return value.getTime();\n    }\n    else if (isArray(value)) {\n        return value.map(comparable);\n    }\n    else if (value && typeof value.toJSON === \"function\") {\n        return value.toJSON();\n    }\n    return value;\n};\nexport var isArray = typeChecker(\"Array\");\nexport var isObject = typeChecker(\"Object\");\nexport var isFunction = typeChecker(\"Function\");\nexport var isVanillaObject = function (value) {\n    return (value &&\n        (value.constructor === Object ||\n            value.constructor === Array ||\n            value.constructor.toString() === \"function Object() { [native code] }\" ||\n            value.constructor.toString() === \"function Array() { [native code] }\") &&\n        !value.toJSON);\n};\nexport var equals = function (a, b) {\n    if (a == null && a == b) {\n        return true;\n    }\n    if (a === b) {\n        return true;\n    }\n    if (Object.prototype.toString.call(a) !== Object.prototype.toString.call(b)) {\n        return false;\n    }\n    if (isArray(a)) {\n        if (a.length !== b.length) {\n            return false;\n        }\n        for (var i = 0, length_1 = a.length; i < length_1; i++) {\n            if (!equals(a[i], b[i]))\n                return false;\n        }\n        return true;\n    }\n    else if (isObject(a)) {\n        if (Object.keys(a).length !== Object.keys(b).length) {\n            return false;\n        }\n        for (var key in a) {\n            if (!equals(a[key], b[key]))\n                return false;\n        }\n        return true;\n    }\n    return false;\n};\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { isArray, isVanillaObject, comparable, equals } from \"./utils\";\n/**\n * Walks through each value given the context - used for nested operations. E.g:\n * { \"person.address\": { $eq: \"blarg\" }}\n */\nvar walkKeyPathValues = function (item, keyPath, next, depth, key, owner) {\n    var currentKey = keyPath[depth];\n    // if array, then try matching. Might fall through for cases like:\n    // { $eq: [1, 2, 3] }, [ 1, 2, 3 ].\n    if (isArray(item) && isNaN(Number(currentKey))) {\n        for (var i = 0, length_1 = item.length; i < length_1; i++) {\n            // if FALSE is returned, then terminate walker. For operations, this simply\n            // means that the search critera was met.\n            if (!walkKeyPathValues(item[i], keyPath, next, depth, i, item)) {\n                return false;\n            }\n        }\n    }\n    if (depth === keyPath.length || item == null) {\n        return next(item, key, owner);\n    }\n    return walkKeyPathValues(item[currentKey], keyPath, next, depth + 1, currentKey, item);\n};\nvar BaseOperation = /** @class */ (function () {\n    function BaseOperation(params, owneryQuery, options) {\n        this.params = params;\n        this.owneryQuery = owneryQuery;\n        this.options = options;\n        this.init();\n    }\n    BaseOperation.prototype.init = function () { };\n    BaseOperation.prototype.reset = function () {\n        this.done = false;\n        this.success = false;\n    };\n    return BaseOperation;\n}());\nexport { BaseOperation };\nvar GroupOperation = /** @class */ (function (_super) {\n    __extends(GroupOperation, _super);\n    function GroupOperation(params, owneryQuery, options, _children) {\n        var _this = _super.call(this, params, owneryQuery, options) || this;\n        _this._children = _children;\n        return _this;\n    }\n    /**\n     */\n    GroupOperation.prototype.reset = function () {\n        this.success = false;\n        this.done = false;\n        for (var i = 0, length_2 = this._children.length; i < length_2; i++) {\n            this._children[i].reset();\n        }\n    };\n    /**\n     */\n    GroupOperation.prototype.childrenNext = function (item, key, owner) {\n        var done = true;\n        var success = true;\n        for (var i = 0, length_3 = this._children.length; i < length_3; i++) {\n            var childOperation = this._children[i];\n            childOperation.next(item, key, owner);\n            if (!childOperation.success) {\n                success = false;\n            }\n            if (childOperation.done) {\n                if (!childOperation.success) {\n                    break;\n                }\n            }\n            else {\n                done = false;\n            }\n        }\n        this.done = done;\n        this.success = success;\n    };\n    return GroupOperation;\n}(BaseOperation));\nexport { GroupOperation };\nvar QueryOperation = /** @class */ (function (_super) {\n    __extends(QueryOperation, _super);\n    function QueryOperation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     */\n    QueryOperation.prototype.next = function (item, key, parent) {\n        this.childrenNext(item, key, parent);\n    };\n    return QueryOperation;\n}(GroupOperation));\nexport { QueryOperation };\nvar NestedOperation = /** @class */ (function (_super) {\n    __extends(NestedOperation, _super);\n    function NestedOperation(keyPath, params, owneryQuery, options, children) {\n        var _this = _super.call(this, params, owneryQuery, options, children) || this;\n        _this.keyPath = keyPath;\n        /**\n         */\n        _this._nextNestedValue = function (value, key, owner) {\n            _this.childrenNext(value, key, owner);\n            return !_this.done;\n        };\n        return _this;\n    }\n    /**\n     */\n    NestedOperation.prototype.next = function (item, key, parent) {\n        walkKeyPathValues(item, this.keyPath, this._nextNestedValue, 0, key, parent);\n    };\n    return NestedOperation;\n}(GroupOperation));\nexport { NestedOperation };\nexport var createTester = function (a, compare) {\n    if (a instanceof Function) {\n        return a;\n    }\n    if (a instanceof RegExp) {\n        return function (b) { return typeof b === \"string\" && a.test(b); };\n    }\n    var comparableA = comparable(a);\n    return function (b) { return compare(comparableA, comparable(b)); };\n};\nvar EqualsOperation = /** @class */ (function (_super) {\n    __extends(EqualsOperation, _super);\n    function EqualsOperation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    EqualsOperation.prototype.init = function () {\n        this._test = createTester(this.params, this.options.compare);\n    };\n    EqualsOperation.prototype.next = function (item, key, parent) {\n        if (this._test(item, key, parent)) {\n            this.done = true;\n            this.success = true;\n        }\n    };\n    return EqualsOperation;\n}(BaseOperation));\nexport { EqualsOperation };\nexport var createEqualsOperation = function (params, owneryQuery, options) { return new EqualsOperation(params, owneryQuery, options); };\nvar NopeOperation = /** @class */ (function (_super) {\n    __extends(NopeOperation, _super);\n    function NopeOperation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    NopeOperation.prototype.next = function () {\n        this.done = true;\n        this.success = false;\n    };\n    return NopeOperation;\n}(BaseOperation));\nexport { NopeOperation };\nexport var numericalOperationCreator = function (createNumericalOperation) { return function (params, owneryQuery, options) {\n    if (params == null) {\n        return new NopeOperation(params, owneryQuery, options);\n    }\n    return createNumericalOperation(params, owneryQuery, options);\n}; };\nexport var numericalOperation = function (createTester) {\n    return numericalOperationCreator(function (params, owneryQuery, options) {\n        var typeofParams = typeof comparable(params);\n        var test = createTester(params);\n        return new EqualsOperation(function (b) {\n            return typeof comparable(b) === typeofParams && test(b);\n        }, owneryQuery, options);\n    });\n};\nvar createOperation = function (name, params, parentQuery, options) {\n    var operationCreator = options.operations[name];\n    if (!operationCreator) {\n        throw new Error(\"Unsupported operation: \" + name);\n    }\n    return operationCreator(params, parentQuery, options);\n};\nvar containsOperation = function (query) {\n    for (var key in query) {\n        if (key.charAt(0) === \"$\")\n            return true;\n    }\n    return false;\n};\nvar createNestedOperation = function (keyPath, nestedQuery, owneryQuery, options) {\n    if (containsOperation(nestedQuery)) {\n        var _a = createQueryOperations(nestedQuery, options), selfOperations = _a[0], nestedOperations = _a[1];\n        if (nestedOperations.length) {\n            throw new Error(\"Property queries must contain only operations, or exact objects.\");\n        }\n        return new NestedOperation(keyPath, nestedQuery, owneryQuery, options, selfOperations);\n    }\n    return new NestedOperation(keyPath, nestedQuery, owneryQuery, options, [\n        new EqualsOperation(nestedQuery, owneryQuery, options)\n    ]);\n};\nexport var createQueryOperation = function (query, owneryQuery, options) {\n    var _a = createQueryOperations(query, options), selfOperations = _a[0], nestedOperations = _a[1];\n    var ops = __spreadArrays([\n        new NestedOperation([], query, owneryQuery, options, selfOperations)\n    ], nestedOperations);\n    if (ops.length === 1) {\n        return ops[0];\n    }\n    return new QueryOperation(query, owneryQuery, options, ops);\n};\nvar createQueryOperations = function (query, options) {\n    var selfOperations = [];\n    var nestedOperations = [];\n    if (!isVanillaObject(query)) {\n        selfOperations.push(new EqualsOperation(query, query, options));\n        return [selfOperations, nestedOperations];\n    }\n    for (var key in query) {\n        if (key.charAt(0) === \"$\") {\n            var op = createOperation(key, query[key], query, options);\n            // probably just a flag for another operation (like $options)\n            if (op != null) {\n                selfOperations.push(op);\n            }\n        }\n        else {\n            nestedOperations.push(createNestedOperation(key.split(\".\"), query[key], query, options));\n        }\n    }\n    return [selfOperations, nestedOperations];\n};\nexport var createQueryTester = function (query, _a) {\n    var _b = _a === void 0 ? {} : _a, compare = _b.compare, operations = _b.operations;\n    var operation = createQueryOperation(query, null, {\n        compare: compare || equals,\n        operations: Object.assign({}, operations || {})\n    });\n    return function (item, key, owner) {\n        operation.reset();\n        operation.next(item, key, owner);\n        return operation.success;\n    };\n};\n","import { createQueryTester, EqualsOperation } from \"./es5m\";\nimport * as operations from \"./operations\";\n\nconst tester = createQueryTester(\n  { $test: 1 },\n  {\n    operations: {\n      $where: defaultOperations.$where,\n      $test: (params, ownertQuery) => {\n        return new EqualsOperation(params, ownertQuery);\n      }\n    }\n  }\n);\n"],"sourceRoot":""}